<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>`cTOST` Vignette • cTOST</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="`cTOST` Vignette">
<meta property="og:description" content="cTOST">
<meta property="og:image" content="/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">cTOST</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.0.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home"></span>
     
  </a>
</li>
<li>
  <a href="../articles/get_started.html">Get started</a>
</li>
<li>
  <a href="../articles/reproducibility.html">Reproducibility</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/yboulag/cTOST" class="external-link">
    <span class="fa fa-github"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>
<code>cTOST</code> Vignette</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/yboulag/cTOST/blob/HEAD/vignettes/get_started.Rmd" class="external-link"><code>vignettes/get_started.Rmd</code></a></small>
      <div class="hidden name"><code>get_started.Rmd</code></div>

    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>Equivalence testing has first appeared in the field of
pharmacokinetics <span class="citation">Metzler (1974)</span>, and find
their most common application in the context of generic drug
manufacturing <span class="citation">Senn (2021)</span> where the aim is
to determine whether a parameter like the mean variation of treatment
response between a reference and a generic drug falls within a
predetermined equivalence range that we denote <span class="math inline">\((-c,c)\)</span>, indicating that drugs are
equivalent. Deviations within this region would be considered
insignificant as they are too small to reflect the dissimilarity of the
therapeutic effects between the compared treatments. In contrast to
standard hypothesis testing for equality of means, where the null
hypothesis assumes that both means are equal, and the alternative
assumes they are not, equivalence testing reverses the roles of the
hypothesis formulations and considers a region rather than a point.
Specifically, it defines the alternative as the equivalence region
within which the parameter of interest must lie for the treatments to be
considered equivalent, and the null hypothesis as the opposite. This
paradigm puts the burden of proof on equivalence, rather than
non-equality, and emphasizes the importance of assessing the similarity
of treatments in addition to their differences.</p>
</div>
<div class="section level2">
<h2 id="mathematical-setup">Mathematical setup<a class="anchor" aria-label="anchor" href="#mathematical-setup"></a>
</h2>
<p>More formally, the hypotheses of interest are defined as</p>
<p><span class="math display">\[\begin{equation*}
    H_0: \; \theta \not\in \Theta_1 \quad vs. \quad H_1: \; \theta \in
\Theta_1 := (\theta_L, \, \theta_U),
\end{equation*}\]</span></p>
<p>where <span class="math inline">\(\Theta_1=(\theta_L,\theta_U)\)</span> denotes the
range of equivalence whose limits are known constants, and are usually
symmetrical so we define <span class="math inline">\(c:=\theta_U=-\theta_L\)</span>.</p>
<p>Existing approaches, such as the state-of-the-art Two One-Sided Tests
(TOST) <span class="citation">Schuirmann (1987)</span>, have
demonstrated conservativeness and decreased power, particularly for
highly variable responses. This can be demonstrated by computing the
power function which would be evaluated at different points of the
parameter space. In particular, evaluating it at the equivalence bounds
yields the size and shows that it is strictly bounded by the
significance level <span class="math inline">\(\alpha\)</span>. To see
this more clearly, consider a canonical form for the average equivalence
problem in the univariate framework, which consists of two independent
random variables <span class="math inline">\(\widehat{\theta}\)</span>
and <span class="math inline">\(\widehat{\sigma}_{\nu}\)</span> with
distributions</p>
<p><span class="math display">\[\begin{equation*}
    \widehat{\theta} \sim N\left(\theta, \sigma_{\nu}^2\right), \quad
\text{and} \quad \nu\frac{\widehat{\sigma}_{\nu}^2}{\sigma_{\nu}^2} \sim
\chi^2_{\nu},
\end{equation*}\]</span> where <span class="math inline">\(\theta\)</span> is the parameter of interest,
<span class="math inline">\(\sigma_{\nu}\)</span> is the standard error
and <span class="math inline">\(\nu\)</span> are the degrees of
freedom.</p>
<p>The TOST is based on two test statistics</p>
<p><span class="math display">\[\begin{equation*}
T_L := \frac{\widehat{\theta}+c}{\widehat{\sigma}_{\nu}}\sim
t_\nu\left(\frac{\theta+c}{\sigma_\nu}\right), \quad\text{and}\quad T_U
:= \frac{\widehat{\theta}-c}{\widehat{\sigma}_{\nu}}\sim
t_\nu\left(\frac{\theta-c}{\sigma_\nu}\right).
\end{equation*}\]</span> <span class="math inline">\(\text{H}_{0}\)</span> is rejected in favor of
equivalence if both tests simultaneously reject their marginal null
hypotheses, i.e.,</p>
<p><span class="math display">\[\begin{equation*}
     T_L \geq t_{1-\alpha,\nu}, \quad \text{ and} \quad T_U \leq
-t_{1-\alpha,\nu}.
\end{equation*}\]</span></p>
<p>By rearranging the terms, we can define a rejection region for the
TOST: <span class="math display">\[\begin{equation*}
    C_1 := \left\{\widehat{\theta} \in \mathbb{R},\,
\widehat{\sigma}_{\nu} \in \mathbb{R}_+ \,\Big\vert
\,  \vert\widehat{\theta}\vert  \leq  c - t_{1-\alpha,\nu}
\hat{\sigma}_\nu  \right\}.
\end{equation*}\]</span></p>
<p>Given <span class="math inline">\(\alpha\)</span>, <span class="math inline">\(\theta\)</span>, <span class="math inline">\(\sigma_{\nu}\)</span>, <span class="math inline">\(\nu\)</span> and <span class="math inline">\(c\)</span>, the power function of the TOST
corresponds to the probability of rejecting <span class="math inline">\(H_0\)</span>, i.e., the integral of the joint
density of <span class="math inline">\((\hat{\theta},\hat{\sigma}_\nu)\)</span> over the
rejection area <span class="math inline">\(C_1\)</span> (see also <span class="citation">Phillips (1990)</span>), that is <span class="math display">\[\begin{equation*}
    \begin{aligned}
        p(\alpha, \theta, \sigma_{\nu}, \nu, c) :=&amp; \Pr\left(T_L
\geq t_{1-\alpha,\nu}\; \text{{ and}} \;  T_U \leq
-t_{1-\alpha,\nu}\,  \big|\;  \alpha, \theta, \sigma_{\nu}, \nu, c
\right)\\
        =&amp;\int_0^\infty I(\widehat\sigma_\nu t_{1-\alpha,\nu} &lt;
c)\left\{\Phi\left(\frac{c+t_{\alpha,\nu}
\widehat\sigma_\nu-\theta}{\sigma_\nu}\right)
    -\Phi\left(-\frac{c+ t_{\alpha,\nu}
\widehat\sigma_\nu+\theta}{\sigma_\nu}
    \right) \right\} \\
        \phantom{=}&amp;\times f_W ( \widehat\sigma_\nu \lvert
\sigma_\nu,\nu)d\widehat\sigma_\nu.
    \end{aligned}
\end{equation*}\]</span> Noting that the vector <span class="math inline">\((T_L,T_U)\)</span> has a bivariate non-central
<span class="math inline">\(t\)</span>-distribution with non-centrality
parameters <span class="math inline">\(\frac{\theta-c}{\sigma_\nu}\)</span> and <span class="math inline">\(\frac{\theta+c}{\sigma_\nu}\)</span> respectively,
we can express the power function in terms of Owen’s <span class="math inline">\(Q\)</span>-function <span class="citation">Owen
(1965)</span>: <span class="math display">\[\begin{equation*}
    \begin{aligned}
        p(\alpha, \theta, \sigma_{\nu}, \nu, c) :=&amp;
Q_{\nu}\left(-t_{1-\alpha,\nu},\, \frac{\theta - c}{\sigma_{\nu}},\,
\frac{c \sqrt{\nu}}{\sigma_{\nu} t_{1-\alpha,\nu}} \right) -
Q_{\nu}\left(t_{1-\alpha,\nu},\, \frac{\theta + c}{\sigma_{\nu}},\,
\frac{c \sqrt{\nu}}{\sigma_{\nu} t_{1-\alpha,\nu}} \right).
    \end{aligned}
\end{equation*}\]</span></p>
</div>
<div class="section level2">
<h2 id="conservativeness-of-the-tost">Conservativeness of the TOST<a class="anchor" aria-label="anchor" href="#conservativeness-of-the-tost"></a>
</h2>
<p>This formulation allows to demonstrate that, for <span class="math inline">\(\sigma_{\nu}&gt;0\)</span>, the TOST is not
size-<span class="math inline">\(\alpha\)</span> in finite samples as
<span class="math display">\[\begin{equation*}
    \begin{aligned}
    \omega_\nu(\alpha, c, \sigma_{\nu}) &amp;:= \sup_{\theta \, \in \,
\Theta_0}\; p(\alpha, \theta, \sigma_{\nu}, \nu, c) \\
    &amp;&lt; Q_{\nu}\left(-t_{1-\alpha,\nu},\, 0,\, \frac{c
\sqrt{\nu}}{\sigma_{\nu} t_{1-\alpha,\nu}} \right) &lt; \Pr\left(T_{\nu}
\leq -t_{1-\alpha,\nu}\right) = \alpha,
    \end{aligned}
\end{equation*}\]</span> where <span class="math inline">\(\Theta_0:=\mathbb{R}\setminus(-c,c)\)</span>
corresponds to parameter space under the null.</p>
</div>
<div class="section level2">
<h2 id="finite-sample-corrections-to-the-tost">Finite sample corrections to the TOST<a class="anchor" aria-label="anchor" href="#finite-sample-corrections-to-the-tost"></a>
</h2>
<p>As <span class="math inline">\(\omega_\nu(\gamma, \delta,
\sigma_{\nu})\)</span> is continuously differentiable and strictly
increasing in <span class="math inline">\(\gamma\)</span> and <span class="math inline">\(\delta\)</span>, solving the following matching
paradigms represents a finite sample correction to the TOST and would
ensure size-<span class="math inline">\(\alpha\)</span> tests: <span class="math display">\[\alpha^*:=\text{argzero}_{\gamma \in [\alpha,
0.5)} \;\big[ \omega_\nu(\gamma, c, \sigma_{\nu}) -
\alpha\big],\]</span> <span class="math display">\[c^*:=\text{argzero}_{\delta \in [1, \infty)}
\;\big[ \omega_\nu(\alpha, \delta, \sigma_{\nu}) -
\alpha\big].\]</span></p>
<p>The conditions under which the solutions are singletons and provide a
uniformly more powerful inference are studied in length in <span class="citation">Boulaguiem et al. (2023)</span> and compared to
existing methods.</p>
</div>
<div class="section level2">
<h2 class="unnumbered" id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-boulaguiem2023finite" class="csl-entry">
Boulaguiem, Y., J. Quartier, M. Lapteva, Y. N. Kalia, M.-P.
Victoria-Feser, S. Guerrier, and D.-L. Couturier. 2023. <span>“Finite
Sample Adjustments for Average Equivalence Testing.”</span>
<em>Statistics in Medicine</em>, 2023–03.
</div>
<div id="ref-Metzler74" class="csl-entry">
Metzler, C. M. 1974. <span>“Bioavailability – a Problem in
Equivalence.”</span> <em>Journal of Pharmaceutical Sciences</em> 30:
309–17.
</div>
<div id="ref-Owen65" class="csl-entry">
Owen, D. B. 1965. <span>“<span class="nocase">A special case of a
bivariate non-central <span class="math inline">\(t\)</span>-distribution</span>.”</span>
<em>Biometrika</em> 52: 437–46.
</div>
<div id="ref-Phil90" class="csl-entry">
Phillips, K. 1990. <span>“Power of the Two One-Sided Tests Procedure in
Bioequivalence.”</span> <em>Journal of Pharmacokinetics and
Biopharmaceutics</em> 18: 137–44.
</div>
<div id="ref-schuirmann1987comparison" class="csl-entry">
Schuirmann, D. J. 1987. <span>“A Comparison of the Two One-Sided Tests
Procedure and the Power Approach for Assessing the Equivalence of
Average Bioavailability.”</span> <em>Journal of Pharmacokinetics and
Biopharmaceutics</em> 15 (6): 657–80.
</div>
<div id="ref-SennBook21" class="csl-entry">
Senn, S. 2021. <em>Statistical Issues in Drug Development, 3rd
Edition</em>. Wiley.
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Younes Boulaguiem, Stéphane Guerrier, Dominique-Laurent Couturier.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
