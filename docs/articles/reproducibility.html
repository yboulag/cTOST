<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Results Reproducibility • cTOST</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Results Reproducibility">
<meta property="og:description" content="cTOST">
<meta property="og:image" content="/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">cTOST</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.0.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home"></span>
     
  </a>
</li>
<li>
  <a href="../articles/get_started.html">Get started</a>
</li>
<li>
  <a href="../articles/reproducibility.html">Reproducibility</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/yboulag/cTOST" class="external-link">
    <span class="fa fa-github"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="reproducibility_files/htmlwidgets-1.6.4/htmlwidgets.js"></script><link href="reproducibility_files/asciinema_player-2.6.1/asciinema-player.css" rel="stylesheet">
<script src="reproducibility_files/asciinema_player-2.6.1/asciinema-player.js"></script><script src="reproducibility_files/asciinema_player-binding-1.0.0/asciinema_player.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Results Reproducibility</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/yboulag/cTOST/blob/HEAD/vignettes/reproducibility.Rmd" class="external-link"><code>vignettes/reproducibility.Rmd</code></a></small>
      <div class="hidden name"><code>reproducibility.Rmd</code></div>

    </div>

    
    
<div class="section level2">
<h2 id="case-study-evaluation-of-bioequivalence-for-econazole-nitrate-deposition-in-porcine-skin">Case study: Evaluation of Bioequivalence for Econazole Nitrate Deposition in Porcine Skin<a class="anchor" aria-label="anchor" href="#case-study-evaluation-of-bioequivalence-for-econazole-nitrate-deposition-in-porcine-skin"></a>
</h2>
<p>In the following we use the methodology developed in this paper for the evaluation of the bioequivalence of two cream products. The dataset was provided by the authors of <span class="citation">Quartier et al. (2019)</span>, who use the cutaneous bioequivalence method detailed in their paper. It contains <span class="math inline">\(17\)</span> pairs of comparable porcine skin samples on which measurements of econazole nitrate deposition (an antifungal medication used to treat skin infections) were collected using two bioequivalent products. These measurements were then considered on the logarithmic scale and saved as an RData file called <code>skin</code>.</p>
<p>The results presented in Figure 4 of <span class="citation">Boulaguiem et al. (2023)</span> can be reproduced as follows:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/yboulag/cTOST" class="external-link">cTOST</a></span><span class="op">)</span>
<span class="co">#&gt; Loading required package: PowerTOST</span>
<span class="co">#&gt; Loading required package: cli</span>
<span class="co">#&gt; Loading required package: knitr</span>
<span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">skin</span><span class="op">)</span>

<span class="co"># Empty plot</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">1</span>,pch<span class="op">=</span><span class="st">""</span>,axes<span class="op">=</span><span class="cn">FALSE</span>,xlab<span class="op">=</span><span class="st">""</span>,ylab<span class="op">=</span><span class="st">""</span>,main<span class="op">=</span><span class="st">""</span>,
     ylim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unlist.html" class="external-link">unlist</a></span><span class="op">(</span><span class="va">skin</span><span class="op">)</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fl">4000</span><span class="op">)</span><span class="op">)</span>,xlim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.75</span>, <span class="fl">2.25</span><span class="op">)</span><span class="op">)</span>

<span class="co"># Plotting and linking the paired data points of each group</span>
<span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">skin</span><span class="op">)</span><span class="op">)</span><span class="op">{</span>
  <span class="fu"><a href="https://rdrr.io/r/graphics/points.html" class="external-link">points</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span>,<span class="va">skin</span><span class="op">[</span><span class="va">i</span>,<span class="op">]</span>,col<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/grDevices/gray.html" class="external-link">gray</a></span><span class="op">(</span><span class="fl">0.1</span><span class="op">)</span>,<span class="fl">50</span><span class="op">)</span>,pch<span class="op">=</span><span class="fl">16</span><span class="op">)</span>
  <span class="fu"><a href="https://rdrr.io/r/graphics/segments.html" class="external-link">segments</a></span><span class="op">(</span><span class="fl">1</span>,<span class="va">skin</span><span class="op">[</span><span class="va">i</span>,<span class="fl">1</span><span class="op">]</span>,<span class="fl">2</span>,<span class="va">skin</span><span class="op">[</span><span class="va">i</span>,<span class="fl">2</span><span class="op">]</span>,
           col<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/grDevices/gray.html" class="external-link">gray</a></span><span class="op">(</span><span class="fl">0.1</span><span class="op">)</span>,<span class="fl">50</span><span class="op">)</span><span class="op">)</span>
<span class="op">}</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/axis.html" class="external-link">axis</a></span><span class="op">(</span><span class="fl">1</span>, at <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Reference"</span>, <span class="st">"Generic"</span><span class="op">)</span>,tick<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/axis.html" class="external-link">axis</a></span><span class="op">(</span><span class="fl">2</span>, at <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">250</span>,<span class="fl">500</span>,<span class="fl">1000</span>,<span class="fl">2000</span>,<span class="fl">4000</span><span class="op">)</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">250</span>,<span class="fl">500</span>,<span class="fl">1000</span>,<span class="fl">2000</span>,<span class="fl">4000</span><span class="op">)</span>, las<span class="op">=</span><span class="fl">2</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/axis.html" class="external-link">axis</a></span><span class="op">(</span><span class="fl">2</span>, at <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unlist.html" class="external-link">unlist</a></span><span class="op">(</span><span class="va">skin</span><span class="op">)</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fl">4000</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"ECZ deposition (ng/cm"</span><span class="op">^</span><span class="fl">2</span><span class="op">*</span><span class="st">")"</span><span class="op">)</span><span class="op">)</span>,padj<span class="op">=</span><span class="op">-</span><span class="fl">4.5</span>, tick <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></code></pre></div>
<p><img src="reproducibility_files/figure-html/unnamed-chunk-2-1.png" width="100%"></p>
<div class="section level3">
<h3 id="bioequivalence-assessment">Bioequivalence assessment<a class="anchor" aria-label="anchor" href="#bioequivalence-assessment"></a>
</h3>
<p>In order to assess bioequivalence, we extract each of means between the two groups, the number of degrees of freedom, and the standard error:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Difference in means between the two groups</span>
<span class="va">theta_hat</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/diff.html" class="external-link">diff</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">skin</span>,<span class="fl">2</span>,<span class="va">mean</span><span class="op">)</span><span class="op">)</span> 

<span class="co"># Number of degrees of freedom</span>
<span class="va">nu</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">skin</span><span class="op">)</span><span class="op">-</span><span class="fl">1</span> 

<span class="co"># Standard error</span>
<span class="va">sig_hat</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html" class="external-link">sd</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">skin</span>,<span class="fl">1</span>,<span class="va">diff</span><span class="op">)</span><span class="op">)</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="va">nu</span><span class="op">)</span></code></pre></div>
<p>We consider in the paper a significance level of <span class="math inline">\(5\%\)</span> and an equivalence limit at <span class="math inline">\(\text{delta}=log(1.25)\)</span>.</p>
<div class="section level4">
<h4 id="standard-tost">Standard TOST<a class="anchor" aria-label="anchor" href="#standard-tost"></a>
</h4>
<p>Considering these parameters, the standard TOST does not accept bioequivalence:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">res_tost</span> <span class="op">=</span> <span class="fu"><a href="../reference/tost.html">tost</a></span><span class="op">(</span>theta <span class="op">=</span> <span class="va">theta_hat</span>, sigma <span class="op">=</span> <span class="va">sig_hat</span>, nu <span class="op">=</span> <span class="va">nu</span>, alpha <span class="op">=</span> <span class="fl">0.05</span>, delta <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fl">1.25</span><span class="op">)</span><span class="op">)</span>
<span class="va">res_tost</span></code></pre></div>
<p><img src="reproducibility_files/figure-html/unnamed-chunk-5.svg" width="100%"></p>
</div>
<div class="section level4">
<h4 id="delta-tost">
<span class="math inline">\(\delta\)</span>-TOST<a class="anchor" aria-label="anchor" href="#delta-tost"></a>
</h4>
<p>Using the <span class="math inline">\(\delta\)</span>-TOST, we still cannot accept bioequivalence, even though the corrected region is larger:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">res_dtost</span> <span class="op">=</span> <span class="fu"><a href="../reference/dtost.html">dtost</a></span><span class="op">(</span>theta <span class="op">=</span> <span class="va">theta_hat</span>, sigma <span class="op">=</span> <span class="va">sig_hat</span>, nu <span class="op">=</span> <span class="va">nu</span>, alpha <span class="op">=</span> <span class="fl">0.05</span>, delta <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fl">1.25</span><span class="op">)</span><span class="op">)</span>
<span class="va">res_dtost</span></code></pre></div>
<p><img src="reproducibility_files/figure-html/unnamed-chunk-7.svg" width="100%"></p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/compare_to_tost.html">compare_to_tost</a></span><span class="op">(</span><span class="va">res_dtost</span><span class="op">)</span></code></pre></div>
<p><img src="reproducibility_files/figure-html/unnamed-chunk-9.svg" width="100%"></p>
</div>
<div class="section level4">
<h4 id="alpha-tost">
<span class="math inline">\(\alpha\)</span>-TOST<a class="anchor" aria-label="anchor" href="#alpha-tost"></a>
</h4>
<p>However, the <span class="math inline">\(\alpha\)</span>-TOST allows us to accept bioequivalence:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">res_atost</span> <span class="op">=</span> <span class="fu"><a href="../reference/atost.html">atost</a></span><span class="op">(</span>theta <span class="op">=</span> <span class="va">theta_hat</span>, sigma <span class="op">=</span> <span class="va">sig_hat</span>, nu <span class="op">=</span> <span class="va">nu</span>, alpha <span class="op">=</span> <span class="fl">0.05</span>, delta <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fl">1.25</span><span class="op">)</span><span class="op">)</span>
<span class="va">res_atost</span></code></pre></div>
<p><img src="reproducibility_files/figure-html/unnamed-chunk-11.svg" width="100%"></p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/compare_to_tost.html">compare_to_tost</a></span><span class="op">(</span><span class="va">res_atost</span><span class="op">)</span></code></pre></div>
<p><img src="reproducibility_files/figure-html/unnamed-chunk-13.svg" width="100%"></p>
</div>
</div>
<div class="section level3">
<h3 id="interval-inclusion-principal-with-the-alpha-tost">Interval Inclusion Principal with the <span class="math inline">\(\alpha\)</span>-TOST<a class="anchor" aria-label="anchor" href="#interval-inclusion-principal-with-the-alpha-tost"></a>
</h3>
<p>To visually assess bioequivalence with the interval inclusion principal, we reproduce Figure 5 of <span class="citation">Boulaguiem et al. (2023)</span> with the following code:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Nominal level and zquivalence bounds</span>
<span class="va">alpha</span> <span class="op">=</span> <span class="fl">0.05</span>
<span class="va">delta</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fl">1.25</span><span class="op">)</span>

<span class="co"># Empty plot</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="cn">NA</span>, axes <span class="op">=</span> <span class="cn">F</span>, xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">0.25</span>, <span class="fl">0.25</span><span class="op">)</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="fl">2.5</span><span class="op">)</span>, xlab <span class="op">=</span> <span class="st">" "</span>, ylab <span class="op">=</span> <span class="st">" "</span><span class="op">)</span>

<span class="co"># Corrected level used by aTOST</span>
<span class="va">alpha_star</span> <span class="op">=</span> <span class="va">res_atost</span><span class="op">$</span><span class="va">corrected_alpha</span>

<span class="co"># TOST's CI upper and lower bound</span>
<span class="va">a1</span> <span class="op">=</span> <span class="va">theta_hat</span> <span class="op">+</span> <span class="va">sig_hat</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/stats/TDist.html" class="external-link">qt</a></span><span class="op">(</span><span class="va">alpha</span>, df <span class="op">=</span> <span class="va">nu</span><span class="op">)</span>
<span class="va">a2</span> <span class="op">=</span> <span class="va">theta_hat</span> <span class="op">-</span> <span class="va">sig_hat</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/stats/TDist.html" class="external-link">qt</a></span><span class="op">(</span><span class="va">alpha</span>, df <span class="op">=</span> <span class="va">nu</span><span class="op">)</span>

<span class="co"># aTOST's CI upper and lower bound </span>
<span class="va">b1</span> <span class="op">=</span> <span class="va">theta_hat</span> <span class="op">+</span> <span class="va">sig_hat</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/stats/TDist.html" class="external-link">qt</a></span><span class="op">(</span><span class="va">alpha_star</span>, df <span class="op">=</span> <span class="va">nu</span><span class="op">)</span>
<span class="va">b2</span> <span class="op">=</span> <span class="va">theta_hat</span> <span class="op">-</span> <span class="va">sig_hat</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/stats/TDist.html" class="external-link">qt</a></span><span class="op">(</span><span class="va">alpha_star</span>, df <span class="op">=</span> <span class="va">nu</span><span class="op">)</span>

<span class="co"># Set the colors and their transparent counterpart</span>
<span class="va">cols</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"coral"</span>,<span class="st">"palegreen2"</span><span class="op">)</span>
<span class="va">t.cols</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"coral"</span>,<span class="st">"palegreen2"</span><span class="op">)</span>,<span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">{</span>
  <span class="va">rgb.val</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/col2rgb.html" class="external-link">col2rgb</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>
  <span class="fu"><a href="https://rdrr.io/r/grDevices/rgb.html" class="external-link">rgb</a></span><span class="op">(</span><span class="va">rgb.val</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, <span class="va">rgb.val</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>, <span class="va">rgb.val</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span>,
      max <span class="op">=</span> <span class="fl">255</span>,
      alpha <span class="op">=</span> <span class="fl">127.5</span><span class="op">)</span>
<span class="op">}</span><span class="op">)</span>

<span class="co"># Plotting the TOST and aTOST CIs</span>
<span class="va">d</span> <span class="op">=</span> <span class="fl">0.1</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/polygon.html" class="external-link">polygon</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">a1</span>, <span class="va">a2</span>, <span class="va">a2</span>, <span class="va">a1</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">-</span><span class="va">d</span>, <span class="fl">1</span><span class="op">-</span><span class="va">d</span>, <span class="fl">1</span><span class="op">+</span><span class="va">d</span>, <span class="fl">1</span><span class="op">+</span><span class="va">d</span><span class="op">)</span> <span class="op">+</span> <span class="fl">1</span>, border <span class="op">=</span> <span class="cn">NA</span>,
        col <span class="op">=</span> <span class="va">t.cols</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/polygon.html" class="external-link">polygon</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">delta</span>, <span class="va">a2</span>, <span class="va">a2</span>, <span class="va">delta</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">-</span><span class="va">d</span>, <span class="fl">1</span><span class="op">-</span><span class="va">d</span>, <span class="fl">1</span><span class="op">+</span><span class="va">d</span>, <span class="fl">1</span><span class="op">+</span><span class="va">d</span><span class="op">)</span> <span class="op">+</span> <span class="fl">1</span>, border <span class="op">=</span> <span class="cn">NA</span>,
        col <span class="op">=</span> <span class="va">cols</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, density <span class="op">=</span> <span class="fl">20</span>, angle <span class="op">=</span> <span class="fl">45</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/polygon.html" class="external-link">polygon</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">delta</span>, <span class="va">a2</span>, <span class="va">a2</span>, <span class="va">delta</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">-</span><span class="va">d</span>, <span class="fl">1</span><span class="op">-</span><span class="va">d</span>, <span class="fl">1</span><span class="op">+</span><span class="va">d</span>, <span class="fl">1</span><span class="op">+</span><span class="va">d</span><span class="op">)</span> <span class="op">+</span> <span class="fl">1</span>, border <span class="op">=</span> <span class="cn">NA</span>,
        col <span class="op">=</span> <span class="va">cols</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, density <span class="op">=</span> <span class="fl">20</span>, angle <span class="op">=</span> <span class="op">-</span><span class="fl">45</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/polygon.html" class="external-link">polygon</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">b1</span>, <span class="va">b2</span>, <span class="va">b2</span>, <span class="va">b1</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">-</span><span class="va">d</span>, <span class="fl">1</span><span class="op">-</span><span class="va">d</span>, <span class="fl">1</span><span class="op">+</span><span class="va">d</span>, <span class="fl">1</span><span class="op">+</span><span class="va">d</span><span class="op">)</span>, border <span class="op">=</span> <span class="cn">NA</span>,
        col <span class="op">=</span> <span class="va">t.cols</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span>

<span class="co"># Plotting the difference in means</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/points.html" class="external-link">points</a></span><span class="op">(</span><span class="va">theta_hat</span>, <span class="fl">2</span>, col <span class="op">=</span> <span class="va">cols</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, pch <span class="op">=</span> <span class="fl">16</span>, cex <span class="op">=</span> <span class="fl">2.5</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/points.html" class="external-link">points</a></span><span class="op">(</span><span class="va">theta_hat</span>, <span class="fl">1</span>, col <span class="op">=</span> <span class="va">cols</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>, pch <span class="op">=</span> <span class="fl">16</span>, cex <span class="op">=</span> <span class="fl">2.5</span><span class="op">)</span>

<span class="co"># Adding text for readability</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/text.html" class="external-link">text</a></span><span class="op">(</span><span class="fl">0.15</span>, <span class="fl">2</span> <span class="op">+</span> <span class="fl">1.75</span><span class="op">*</span><span class="va">d</span>, <span class="st">"TOST CI"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/text.html" class="external-link">text</a></span><span class="op">(</span><span class="fl">0.15</span>, <span class="fl">1</span> <span class="op">+</span> <span class="fl">1.75</span><span class="op">*</span><span class="va">d</span>, <span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="va">alpha</span>,<span class="st">"TOST CI"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/graphics/text.html" class="external-link">text</a></span><span class="op">(</span><span class="fl">0.22</span>, <span class="fl">2</span> <span class="op">-</span> <span class="fl">1.75</span><span class="op">*</span><span class="va">d</span>, <span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"outside (-"</span>,<span class="va">delta</span>,<span class="st">", "</span>,<span class="va">delta</span>,<span class="st">")"</span><span class="op">)</span><span class="op">)</span>, cex <span class="op">=</span> <span class="fl">0.8</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span>v <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">0.3</span>, <span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fl">1.25</span><span class="op">)</span>, <span class="op">-</span><span class="fl">0.1</span>, <span class="fl">0</span>, <span class="fl">0.1</span>, <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fl">1.25</span><span class="op">)</span>, <span class="fl">0.3</span><span class="op">)</span>,
       col <span class="op">=</span> <span class="st">"grey65"</span>, lty <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/axis.html" class="external-link">axis</a></span><span class="op">(</span><span class="fl">1</span>, at <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">0.3</span>, <span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fl">1.25</span><span class="op">)</span>, <span class="op">-</span><span class="fl">0.1</span>, <span class="fl">0</span>, <span class="fl">0.1</span>, <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fl">1.25</span><span class="op">)</span>, <span class="fl">0.3</span><span class="op">)</span>,
     labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"-0.3"</span>, <span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"-"</span>,<span class="va">delta</span><span class="op">)</span><span class="op">)</span>, <span class="st">"-0.1"</span>, <span class="st">"0"</span>, <span class="st">"0.1"</span>,
                <span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="va">delta</span><span class="op">)</span>, <span class="st">"0.3"</span><span class="op">)</span>,padj<span class="op">=</span><span class="op">-</span><span class="fl">0.15</span>,cex.axis<span class="op">=</span><span class="fl">1.3</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/mtext.html" class="external-link">mtext</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="va">theta</span><span class="op">)</span>, side <span class="op">=</span> <span class="fl">1</span>, line <span class="op">=</span> <span class="fl">2.35</span>, cex <span class="op">=</span> <span class="fl">1.4</span><span class="op">)</span></code></pre></div>
<p><img src="reproducibility_files/figure-html/unnamed-chunk-15-1.png" width="100%"></p>
</div>
</div>
<div class="section level2">
<h2 class="unnumbered" id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-boulaguiem2023finite" class="csl-entry">
Boulaguiem, Y., J. Quartier, M. Lapteva, Y. N. Kalia, M.-P. Victoria-Feser, S. Guerrier, and D.-L. Couturier. 2023. <span>“Finite Sample Adjustments for Average Equivalence Testing.”</span> <em>Statistics in Medicine</em>, 2023–03.
</div>
<div id="ref-quartier2019cutaneous" class="csl-entry">
Quartier, J., N. Capony, M. Lapteva, and Y. N. Kalia. 2019. <span>“Cutaneous Biodistribution: A High-Resolution Methodology to Assess Bioequivalence in Topical Skin Delivery.”</span> <em>Pharmaceutics</em> 11 (9): 484.
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Younes Boulaguiem, Stéphane Guerrier, Dominique-Laurent Couturier.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
